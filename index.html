<script>
    // [Previous functions: seededRandom, generateDailyMessage, horoscopes, zodiacSigns unchanged]

    // Get the sign from the URL
    const params = new URLSearchParams(window.location.search);
    const sign = params.get('sign');
    console.log("Sign from URL:", sign);

    const content = document.getElementById('content');
    const loading = document.getElementById('loading');
    
    if (!content || !loading) {
        console.error("DOM elements not found: content or loading missing");
    }

    function showContent() {
        console.log("Showing content");
        loading.style.display = 'none';
        content.style.display = 'block';
    }

    setTimeout(() => {
        try {
            console.log("setTimeout executed");
            const today = new Date();
            const dateSeed = today.getFullYear() * 10000 + (today.getMonth() + 1) * 100 + today.getDate();

            if (sign && horoscopes[sign.toLowerCase()]) {
                console.log("Sign recognized:", sign);
                const signLower = sign.toLowerCase();
                const data = horoscopes[signLower];
                const dailyMessage = generateDailyMessage(signLower, dateSeed);
                
                const matchIndex = Math.floor(seededRandom(dateSeed + 1) * zodiacSigns.length);
                const romanticMatch = zodiacSigns[matchIndex];

                const moonIndex = Math.floor(seededRandom(dateSeed + 2) * data.moonOptions.length);
                const moonSign = data.moonOptions[moonIndex];

                const formattedDate = today.toLocaleDateString('en-US', {
                    weekday: 'long',
                    year: 'numeric',
                    month: "long",
                    day: 'numeric'
                });
                
                content.innerHTML = `
                    <div class="sign">${sign.charAt(0).toUpperCase() + sign.slice(1)}</div>
                    <div class="date">${formattedDate}</div>
                    <div class="reading">${dailyMessage}</div>
                    <div class="details">
                        <div class="detail-box">
                            <div class="detail-label">Best Romantic Match</div>
                            <div class="detail-value">${romanticMatch}</div>
                        </div>
                        <div class="detail-box">
                            <div class="detail-label">Color</div>
                            <div class="detail-value">${data.color}</div>
                        </div>
                        <div class="detail-box">
                            <div class="detail-label">Mood</div>
                            <div class="detail-value">${data.mood}</div>
                        </div>
                        <div class="detail-box">
                            <div class="detail-label">Sun & Moon</div>
                            <div class="detail-value">${data.sun} / ${moonSign}</div>
                        </div>
                    </div>
                `;
            } else {
                console.log("No valid sign, showing welcome message");
                content.innerHTML = `
                    <div class="reading">
                        <div class="sign">Daily Vibes</div>
                        <p>Welcome to your daily horoscope reading.</p>
                        <p>Scan your zodiac sign's NFC tag to see your reading.</p>
                    </div>
                `;
            }
            showContent();
        } catch (error) {
            console.error("Error in setTimeout:", error);
            content.innerHTML = `<div class="reading">Oops! Something went wrong. Please try again.</div>`;
            showContent();
        }
    }, 1000);

    if (window.navigator.standalone) {
        document.documentElement.style.height = '100vh';
        document.body.style.height = '100vh';
    }
</script>